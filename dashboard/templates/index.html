
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Wind Forecast Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      body {
        background-color: #12161a;
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        background-repeat: no-repeat;
        color: #e0e0e0;
        font-family: 'Inter', sans-serif;
        margin: 0;
        padding: 0;
        min-height: 100vh;
      }
      .hero {
        background: linear-gradient(135deg, rgba(15, 32, 39, 0.9) 0%, rgba(44, 83, 100, 0.9) 100%);
        color: #fff;
        padding: 32px 0 20px 0;
        text-align: center;
        border-radius: 0 0 10px 10px;
      }
      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 24px;
        background: rgba(35, 39, 43, 0.95);
        border-radius: 10px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(5px);
      }
      .tab {
        overflow: hidden;
        border: 1px solid #222;
        background-color: rgba(35, 39, 43, 0.95);
        border-radius: 4px 4px 0 0;
        margin: 0;
      }
      .tab button {
        background-color: rgba(35, 39, 43, 0.95);
        color: #d8d8d8;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 15px;
        font-weight: 500;
      }
      .tab button:hover {
        background-color: #343941;
        color: #fff;
      }
      .tab button.active {
        background-color: #1a73e8;
        color: #fff;
      }
      .tabcontent {
        display: none;
        padding: 6px 12px;
        border: 1px solid #222;
        border-top: none;
        background-color: rgba(35, 39, 43, 0.95);
        border-radius: 0 0 4px 4px;
      }
      .file-row label {
        color: #b0b8c1;
        font-weight: 500;
      }
      .file-row input[type="file"] {
        width: 100%;
        padding: 10px;
        background: #181c20;
        color: #e0e0e0;
        border: 1px solid #444;
        border-radius: 4px;
      }
      .actions button,
      .btn.primary {
        background: #1a73e8;
        color: #fff;
        border: none;
        border-radius: 4px;
        padding: 10px 24px;
        font-size: 15px;
        margin-top: 10px;
        cursor: pointer;
        transition: background 0.2s;
      }
      .actions button:hover,
      .btn.primary:hover {
        background: #155ab6;
      }
      .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: 500;
        color: #b0b8c1;
      }
      /* All input fields dark */
      .form-group input[type="number"],
      .form-group input[type="text"],
      .form-group input[type="datetime-local"],
      #csvTab input[type="file"] {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #444;
        border-radius: 4px;
        background: #181c20 !important;
        color: #e0e0e0;
        font-size: 14px;
        box-sizing: border-box;
        transition: border-color 0.3s ease;
      }
      .form-group input[type="number"]:focus,
      .form-group input[type="text"]:focus,
      .form-group input[type="datetime-local"]:focus,
      #csvTab input[type="file"]:focus {
        border-color: #1a73e8;
        background: #23272b;
        color: #fff;
      }
      .time-inputs {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
        max-height: 70vh;
        overflow-y: auto;
        padding: 10px;
      }
      .time-input-group {
        background: #23272b;
        padding: 15px;
        border-radius: 6px;
        border: 1px solid #333;
        box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        transition: all 0.3s ease;
      }
      .time-input-group:hover {
        box-shadow: 0 4px 8px rgba(0,0,0,0.18);
        transform: translateY(-2px);
      }
      .flashes {
        list-style: none;
        padding: 0;
      }
      .flash {
        padding: 10px 16px;
        margin-bottom: 10px;
        border-radius: 4px;
        background: #333950;
        color: #fff;
        font-weight: 500;
      }
      .footer {
        color: #7a8597;
        text-align: center;
        margin-top: 50px;
        font-size: 15px;
      }

      .manual-input-container {
        max-width: 800px;
        margin: 0 auto;
      }
      .date-entry {
        background: #2a3035;
        border: 1px solid #3a4045;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 15px;
        transition: all 0.3s ease;
      }
      .date-entry:hover {
        border-color: #1a73e8;
        box-shadow: 0 4px 12px rgba(26, 115, 232, 0.2);
      }
      .date-entry h4 {
        color: #64b5f6;
        margin: 0 0 15px 0;
        font-size: 16px;
      }
      .date-fields {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }
      .date-field {
        display: flex;
        flex-direction: column;
      }
      .date-field label {
        color: #90caf9;
        font-size: 13px;
        font-weight: 600;
        margin-bottom: 6px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .date-field input {
        background: #181c20;
        border: 1px solid #3a4045;
        border-radius: 4px;
        color: #e0e0e0;
        padding: 10px 12px;
        font-size: 14px;
        transition: all 0.3s ease;
      }
      .date-field input:focus {
        border-color: #1a73e8;
        background: #1f2328;
        color: #fff;
        outline: none;
        box-shadow: 0 0 8px rgba(26, 115, 232, 0.3);
      }
      .manual-button-container {
        text-align: center;
        margin-top: 30px;
      }
      .manual-button-container button {
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%);
        color: #fff;
        border: none;
        border-radius: 6px;
        padding: 14px 48px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3);
      }
      .manual-button-container button:hover {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%);
        box-shadow: 0 6px 16px rgba(26, 115, 232, 0.4);
        transform: translateY(-2px);
      }
      .manual-button-container button:active {
        transform: translateY(0);
      }
      .slider-section {
        background: #2a3035;
        border: 1px solid #3a4045;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
      }
      .slider-group {
        margin-bottom: 20px;
      }
      .slider-group label {
        display: block;
        color: #90caf9;
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .slider-group span {
        color: #64b5f6;
        font-weight: bold;
        margin-left: 5px;
      }
      .slider {
        width: 100%;
        height: 6px;
        border-radius: 3px;
        background: #1a1e22;
        outline: none;
        -webkit-appearance: none;
        appearance: none;
      }
      .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #1a73e8;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 2px 6px rgba(26, 115, 232, 0.4);
      }
      .slider::-webkit-slider-thumb:hover {
        background: #1557b0;
        box-shadow: 0 4px 10px rgba(26, 115, 232, 0.6);
        transform: scale(1.2);
      }
      .slider::-moz-range-thumb {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #1a73e8;
        cursor: pointer;
        border: none;
        transition: all 0.3s ease;
        box-shadow: 0 2px 6px rgba(26, 115, 232, 0.4);
      }
      .slider::-moz-range-thumb:hover {
        background: #1557b0;
        box-shadow: 0 4px 10px rgba(26, 115, 232, 0.6);
        transform: scale(1.2);
      }
      .slider::-moz-range-track {
        background: transparent;
        border: none;
      }
    </style>
  </head>
  <body>
    <div class="hero">
      <h1>Ecorythm : Energy forecasting and management</h1>
      <p>Upload CSV files or enter values manually to forecast the next 24 hours.</p>
    </div>
    
    <main class="container">
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <ul class="flashes">
          {% for category, message in messages %}
            <li class="flash {{ category }}">{{ message }}</li>
          {% endfor %}
          </ul>
        {% endif %}
      {% endwith %}

      <div class="tab">
        <button class="tablinks active" onclick="openTab(event, 'csvTab')">CSV Upload</button>
        <button class="tablinks" onclick="openTab(event, 'manualTab')">Manual Input</button>
      </div>

      <!-- CSV Upload Tab -->
      <div id="csvTab" class="tabcontent" style="display: block;">
        <form action="{{ url_for('predict') }}" method="post" enctype="multipart/form-data" id="csvForm">
          <input type="hidden" name="input_type" value="csv">
          <div class="file-row">
            <label>Upload Wind CSV (24+ rows)</label>
            <input type="file" name="wind_csv" accept=".csv" required>
          </div>
          <div class="file-row">
            <label>Upload Demand CSV (24+ rows)</label>
            <input type="file" name="demand_csv" accept=".csv" required>
          </div>
          <div class="actions">
            <button type="submit" class="btn primary">Upload & Predict</button>
          </div>
        </form>
      </div>

      <!-- Manual Input Tab -->
      <div id="manualTab" class="tabcontent">
        <div class="manual-input-container">
          <form action="{{ url_for('predict') }}" method="post" id="manualForm">
            <input type="hidden" name="input_type" value="manual">
            
            <p style="color: #90caf9; text-align: center; margin-bottom: 30px; font-size: 14px;">
              Select a date and adjust sliders to compare predictions with actual dataset values
            </p>

            <div class="slider-section">
              <h3 style="color: #64b5f6; margin-bottom: 20px;">Date Selection</h3>
              
              <div class="slider-group">
                <label>Select Date</label>
                <input type="date" name="manual_date" id="manual_date" required style="width: 100%; padding: 10px 12px; border: 1px solid #444; border-radius: 4px; background: #181c20 !important; color: #e0e0e0; font-size: 14px; box-sizing: border-box; margin-bottom: 15px;">
              </div>
              <div class="slider-group">
                <label>Select Hour (0-23)</label>
                <input type="number" name="manual_hour" id="manual_hour" min="0" max="23" value="12" required 
                       style="width: 100%; padding: 10px 12px; border: 1px solid #444; border-radius: 4px; 
                              background: #181c20 !important; color: #e0e0e0; font-size: 14px; box-sizing: border-box;">
              </div>
            </div>

            <div class="slider-section">
              <h3 style="color: #64b5f6; margin-bottom: 20px;">Wind Features</h3>
              
              <div class="slider-group">
                <label>Wind Speed (m/s): <span id="wind_speed_value">5.5</span></label>
                <input type="range" name="manual_wind_speed" id="wind_speed" min="0" max="20" step="0.1" value="5.5" class="slider">
                <input type="hidden" name="manual_wind_speed_hidden" id="wind_speed_hidden" value="5.5">
              </div>

              <div class="slider-group">
                <label>Wind Direction (°): <span id="wind_dir_value">180</span></label>
                <input type="range" name="manual_wind_dir" id="wind_dir" min="0" max="360" step="1" value="180" class="slider">
                <input type="hidden" name="manual_wind_dir_hidden" id="wind_dir_hidden" value="180">
              </div>

              <div class="slider-group">
                <label>Pressure (hPa): <span id="pressure_value">1013</span></label>
                <input type="range" name="manual_pressure" id="pressure" min="950" max="1050" step="0.1" value="1013" class="slider">
                <input type="hidden" name="manual_pressure_hidden" id="pressure_hidden" value="1013">
              </div>

              <div class="slider-group">
                <label>Air Temperature (°C): <span id="air_temp_value">20</span></label>
                <input type="range" name="manual_air_temp" id="air_temp" min="-10" max="50" step="0.1" value="20" class="slider">
                <input type="hidden" name="manual_air_temp_hidden" id="air_temp_hidden" value="20">
              </div>
            </div>

            <div class="slider-section">
              <h3 style="color: #64b5f6; margin-bottom: 20px;">Demand Features</h3>
              
              <div class="slider-group">
                <label>Temperature (°C): <span id="temp_value">20</span></label>
                <input type="range" name="manual_temp" id="temp" min="-10" max="50" step="0.1" value="20" class="slider">
                <input type="hidden" name="manual_temp_hidden" id="temp_hidden" value="20">
              </div>

              <div class="slider-group">
                <label>Humidity (%): <span id="humidity_value">65</span></label>
                <input type="range" name="manual_humidity" id="humidity" min="0" max="100" step="0.1" value="65" class="slider">
                <input type="hidden" name="manual_humidity_hidden" id="humidity_hidden" value="65">
              </div>
            </div>

            <div class="manual-button-container">
              <button type="submit">Predict & Compare</button>
            </div>
          </form>
        </div>
      </div>
    </main>

    <footer class="footer">Built for FYP - Wind Energy Management</footer>

    <script>
      function openTab(evt, tabName) {
        // Hide all tab content
        var tabcontent = document.getElementsByClassName("tabcontent");
        for (var i = 0; i < tabcontent.length; i++) {
          tabcontent[i].style.display = "none";
        }

        // Remove active class from all tab buttons
        var tablinks = document.getElementsByClassName("tablinks");
        for (var i = 0; i < tablinks.length; i++) {
          tablinks[i].className = tablinks[i].className.replace(" active", "");
        }

        // Show the current tab and add active class to the button
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
      }

      // Update slider values and display
      document.addEventListener('DOMContentLoaded', function() {
        // Set default date to today
        const dateInput = document.getElementById('manual_date');
        if (dateInput) {
          const today = new Date();
          dateInput.value = today.toISOString().split('T')[0];
        }

        const sliders = [
          { id: 'wind_speed', valueId: 'wind_speed_value' },
          { id: 'wind_dir', valueId: 'wind_dir_value' },
          { id: 'pressure', valueId: 'pressure_value' },
          { id: 'air_temp', valueId: 'air_temp_value' },
          { id: 'temp', valueId: 'temp_value' },
          { id: 'humidity', valueId: 'humidity_value' }
        ];

        sliders.forEach(slider => {
          const element = document.getElementById(slider.id);
          const valueDisplay = document.getElementById(slider.valueId);
          
          if (element && valueDisplay) {
            element.addEventListener('input', function() {
              valueDisplay.textContent = parseFloat(this.value).toFixed(1);
            });
          }
        });
      });

        // Set background image
        document.body.style.backgroundImage = `url('{{ url_for('static', filename='image.png') }}')`;
    </script>
  </body>
</html>
